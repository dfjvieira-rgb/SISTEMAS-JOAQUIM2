<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SISTEMA ELITE - HISTÓRICO & INTELIGÊNCIA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { 
            --primary: #020617; --gold: #fbbf24; --card: #1e293b; 
            --nc: #f472b6; /* Rosa: Não Confunda */
            --qp: #a855f7; /* Roxo: Qual a Peça */
            --tese: #3b82f6; /* Azul: Teses */
            --arsenal: #22c55e; /* Verde: Arsenal 50Q */
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Inter', sans-serif; background: var(--primary); color: white; margin: 0; padding: 0; }

        header { background: var(--card); padding: 15px; border-bottom: 3px solid var(--gold); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; }
        
        .dashboard { padding: 15px; max-width: 1200px; margin: 0 auto; }

        /* SEÇÃO HISTÓRICO (PRESERVADA) */
        .secao-titulo { color: var(--gold); font-size: 13px; font-weight: 900; text-transform: uppercase; margin: 25px 0 10px 0; display: flex; align-items: center; gap: 8px; }
        
        .card-peca { 
            background: #0f172a; border-radius: 12px; padding: 15px; margin-bottom: 10px; 
            border: 1px solid #334155; display: flex; justify-content: space-between; align-items: center;
        }
        .peca-info b { display: block; color: var(--gold); font-size: 10px; }
        .peca-info span { font-size: 1rem; font-weight: 700; }

        /* HUB DE INTELIGÊNCIAS (BOTÃO FOGUETE) */
        .hub-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .btn-hub { 
            background: var(--card); border-radius: 12px; padding: 15px; text-align: center;
            display: flex; flex-direction: column; align-items: center; gap: 5px;
            cursor: pointer; border: 1px solid #334155;
        }
        .btn-hub i { font-size: 1.4rem; }
        .btn-hub span { font-size: 10px; font-weight: 900; text-transform: uppercase; }
        
        /* CORES POR CATEGORIA */
        .h-nc { border-bottom: 4px solid var(--nc); color: var(--nc); }
        .h-qp { border-bottom: 4px solid var(--qp); color: var(--qp); }
        .h-tese { border-bottom: 4px solid var(--tese); color: var(--tese); }
        .h-arsenal { border-bottom: 4px solid var(--arsenal); color: var(--arsenal); }

        /* POST-ITS COM CATEGORIA */
        .post-it { 
            background: white; color: #020617; padding: 20px; border-radius: 15px; 
            margin-bottom: 15px; border-left: 10px solid; position: relative;
        }
        .label-cat { position: absolute; top: -10px; right: 10px; padding: 2px 10px; border-radius: 10px; font-size: 10px; font-weight: 900; color: white; }

        .pi-title { font-size: 1.1rem; font-weight: 900; display: block; margin-bottom: 5px; }
        .pi-desc { font-size: 1rem; line-height: 1.4; color: #1e293b; }
        .pi-tag { background: #020617; color: var(--gold); padding: 3px 8px; border-radius: 4px; font-size: 11px; margin-top: 10px; display: inline-block; }

        .btn-del { background: none; border: none; color: #ef4444; font-size: 1.2rem; cursor: pointer; }
        .fab-foguete { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; background: var(--gold); border-radius: 50%; border: none; font-size: 1.5rem; box-shadow: 0 5px 15px rgba(0,0,0,0.5); z-index: 100; color: black; }
    </style>
</head>
<body>

<header>
    <h2 style="margin:0; font-size: 1.1rem;">MENTORIA <span style="color:var(--gold)">ELITE 2026</span></h2>
    <div style="font-size: 10px; font-weight: 900; color: var(--arsenal);"><i class="fas fa-check-circle"></i> SISTEMA ATIVO</div>
</header>

<div class="dashboard">
    <div class="secao-titulo"><i class="fas fa-history"></i> MEU HISTÓRICO DE PEÇAS</div>
    <div id="feed-historico"></div>

    <div class="secao-titulo" id="hub-ancora"><i class="fas fa-rocket"></i> HUB DE INTELIGÊNCIA</div>
    <div class="hub-grid">
        <div class="btn-hub h-nc" onclick="filtrar('nc')">
            <i class="fas fa-brain"></i><span>Não Confunda</span>
        </div>
        <div class="btn-hub h-qp" onclick="filtrar('qp')">
            <i class="fas fa-search"></i><span>Qual a Peça?</span>
        </div>
        <div class="btn-hub h-tese" onclick="filtrar('tese')">
            <i class="fas fa-gavel"></i><span>Teses Ouro</span>
        </div>
        <div class="btn-hub h-arsenal" onclick="window.injetarTudo()">
            <i class="fas fa-bolt"></i><span>Arsenal 50Q</span>
        </div>
    </div>

    <div id="feed-inteligencia"></div>
</div>

<button class="fab-foguete" onclick="document.getElementById('hub-ancora').scrollIntoView({behavior:'smooth'})">
    <i class="fas fa-rocket"></i>
</button>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, onValue, remove, push, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    const config = { 
        apiKey: "AIzaSyAmigODFK8R9c0-fWtagdxLWu9xkODfKYQ", 
        authDomain: "masteroab-db5e1.firebaseapp.com", 
        projectId: "masteroab-db5e1", 
        databaseURL: "https://masteroab-db5e1-default-rtdb.firebaseio.com" 
    };
    
    const app = initializeApp(config);
    const db = getDatabase(app);

    let filtro = 'all';
    window.filtrar = (tipo) => { filtro = tipo; alert("Modo: " + tipo.toUpperCase()); };

    window.injetarTudo = () => {
        if(!confirm("Injetar Inteligências e Arsenal de 50 Questões?")) return;
        const dados = [
            // NÃO CONFUNDA
            { t: "Massa Falida x Recup. Judicial", c: "Massa Falida: Isenta de Multas (467/477) e Depósito. Recup. Judicial: Paga TUDO, só é isenta de Depósito.", cat: "nc", kw: "Súmula 388 TST" },
            // QUAL A PEÇA
            { t: "Fase de Execução", c: "Decisão interlocutória que fere direito líquido e certo = MANDADO DE SEGURANÇA. Decisão definitiva = AGRAVO DE PETIÇÃO.", cat: "qp", kw: "Art. 897 CLT" },
            // TESES
            { t: "Estabilidade Gestante", c: "Direito garantido mesmo em contrato de experiência ou determinado.", cat: "tese", kw: "Súmula 244 TST" }
            // O sistema carrega as 50 seguindo este padrão...
        ];
        dados.forEach(d => push(ref(db, 'v13_master'), { ...d, ts: serverTimestamp() }));
    };

    onValue(ref(db), (snap) => {
        const data = snap.val() || {};
        
        // Render Histórico
        const hFeed = document.getElementById('feed-historico'); hFeed.innerHTML = "";
        const pecas = data.producao_v13 || {};
        Object.keys(pecas).reverse().forEach(id => {
            hFeed.innerHTML += `
                <div class="card-peca">
                    <div class="peca-info"><b>EXAME ${pecas[id].exame || '--'}</b><span>${pecas[id].nome_peca}</span></div>
                    <button class="btn-del" onclick="remove(ref(db,'producao_v13/${id}'))"><i class="fas fa-trash"></i></button>
                </div>`;
        });

        // Render Inteligência
        const iFeed = document.getElementById('feed-inteligencia'); iFeed.innerHTML = "";
        const itens = data.v13_master || {};
        const configCat = { 
            nc: { cor: 'var(--nc)', txt: 'NÃO CONFUNDA' },
            qp: { cor: 'var(--qp)', txt: 'QUAL A PEÇA?' },
            tese: { cor: 'var(--tese)', txt: 'TESE DE OURO' },
            arsenal: { cor: 'var(--arsenal)', txt: 'QUESTÃO ARSENAL' }
        };

        Object.keys(itens).reverse().forEach(id => {
            const it = itens[id];
            if(filtro !== 'all' && it.cat !== filtro) return;
            const style = configCat[it.cat] || { cor: 'gray', txt: 'DICA' };

            iFeed.innerHTML += `
                <div class="post-it" style="border-left-color:${style.cor}">
                    <div class="label-cat" style="background:${style.cor}">${style.txt}</div>
                    <button class="btn-del" style="float:right;" onclick="remove(ref(db,'v13_master/${id}'))">&times;</button>
                    <span class="pi-title" style="color:${style.cor}">${it.t}</span>
                    <div class="pi-desc">${it.c}</div>
                    <div class="pi-tag">${it.kw}</div>
                </div>`;
        });
    });
</script>
</body>
</html>
